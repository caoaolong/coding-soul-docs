## 创建删除目录

### 创建目录

![MKDIR](../images/MKDIR.svg)

---

1. **寻找`fat_dir_t`的写入位置**  
   - 该步骤确定新目录的存储位置。

2. **创建`fat_dir_t`结构**  
   - 分配一个新的`fat_dir_t`结构，用于存储目录信息。

3. **初始化`fat_dir_t`的数据簇**  
   - 该步骤为目录初始化数据存储单元（簇）。
   - 需要**申请FAT Entry**，即在FAT表中为新目录分配一个条目。

4. **创建`[.]`和`[..]`目录**（即当前目录与父目录）  
   - 在FAT文件系统中，每个目录都会包含这两个特殊目录：
     - `.` 代表当前目录
     - `..` 代表上一级目录

5. **写入`[.]`和`[..]`目录**  
   - 这一步是将上述两个特殊目录项写入文件系统。

6. **写入`fat_dir_t`结构**  
   - 将目录的结构信息写入存储空间。

7. **判断是否为根目录**
   - **是** → 目录直接写入**根目录（Root Directory）**  
   - **否** → 目录写入普通**数据区（Data）**。


### 删除目录

![RMDIR](../images/RMDIR.svg)

---

1. **寻找`fat_dir_t`的位置**  
   - 该步骤用于找到要删除的目录所在的存储位置。

2. **寻找`fat_dir_t`的数据簇**  
   - 目录在FAT文件系统中的数据存储是基于簇的，这一步是找到其数据簇的位置。

3. **释放FAT Entry**  
   - 在FAT表中，目录占用的簇需要被释放，即将对应的FAT表项标记为空闲，以便后续分配。

4. **释放`fat_dir_t`结构**  
   - 目录结构本身的存储空间需要释放，以便清理文件系统中的目录信息。

5. **判断是否为根目录**
   - **是** → 释放的是**根目录**，因此操作涉及根目录区域。  
   - **否** → 释放的是**普通目录**，涉及数据区的释放。