# FAT16文件树

![FAT16](../images/FAT16文件树.svg)

---

FAT16（File Allocation Table 16-bit）文件系统采用了基于链表的分配方式来组织磁盘上的文件数据，它通过一张文件分配表（FAT表）来追踪文件的数据块位置。FAT16的文件树结构的组织方式主要依赖于以下几个关键组件：

1. **根目录（Root Directory）**:
   - 根目录是文件系统的顶层目录，所有文件和子目录都从这里开始。根目录的结构是固定大小的，它包含一系列目录项，每个目录项包含文件的基本信息，如文件名、文件属性、文件大小、文件的起始数据块位置等。
   
2. **FAT表（File Allocation Table）**:
   - FAT表是一个16位的数组，数组中的每个条目代表一个磁盘簇（cluster）。每个簇要么包含文件的数据，要么是一个指向下一个簇的指针，或者是一个“结束标志”（比如0xFFFF表示结束）。文件数据被分成一个个簇，FAT表通过这些簇来链接文件数据块。
   - FAT16最大的文件系统支持的簇数是65536个簇。每个簇的大小通常是2的幂（如512字节、1KB、2KB、4KB等），这取决于磁盘的大小。

3. **文件存储**:
   - 文件内容存储在磁盘上离散的簇中。每个文件的数据簇的顺序和位置通过FAT表中的链表结构来管理。FAT16的文件树实际上是通过FAT表和目录结构之间的关系来实现的，而不是一个像UNIX系统中那样严格的目录树结构。
   
4. **子目录**:
   - 子目录是作为文件的一种特殊类型存在。子目录在FAT16中被看作是一个普通文件，它的起始簇通过FAT表与根目录的记录关联。当打开一个子目录时，系统会根据FAT表查找该目录的起始簇，从而加载该目录内容。

### FAT16的文件树结构大致是这样的：

- 根目录包含一系列文件或子目录项。
- 每个子目录又是一个文件，它包含对该子目录内文件的引用（这些文件也可能是数据文件或子目录）。
- 文件或子目录的数据是分布在磁盘簇中的，这些簇的顺序通过FAT表进行管理。

简单地说，FAT16的文件树并不完全是传统的树形结构，而是以簇为单位，通过FAT表来维护簇之间的顺序。每个文件和子目录都有自己的“链表”，通过FAT表链接。

如果需要进一步探讨FAT16的详细实现或者有其他问题，欢迎随时提问！