## 位图

![位图](../images/位图.svg)

位图（Bitmap）是一种简单且高效的存储和操作大量布尔值（0或1）数据的结构。它利用位（bit）作为最小存储单元，通过压缩表示法节省内存并支持快速的操作。以下是详细的介绍：

---

## **位图的基本概念**
位图是一种将数据存储为二进制位（0或1）序列的结构，用于高效地表示和操作集合或布尔值。每个位的位置表示一个元素的状态，比如存在或不存在、是或否等。

### **位图的存储形式**
- **位数组**：位图通常用连续的二进制位表示，底层实现通常是一个整数数组或字符数组。
  - 每个位表示一个元素。
  - 如：数组 `[1, 0, 1, 1]` 表示集合中第1、3、4个元素存在。
- **索引映射**：位图的索引直接对应于元素的标识，如整数值。

---

## **位图的特点**
1. **节省空间**：
   - 使用位而非字节存储数据，大幅减少内存开销。
   - 如果需要存储范围为 \(n\) 的布尔值，仅需 \(n\) 位空间。

2. **高效操作**：
   - 通过按位操作（如AND、OR、NOT等）实现快速查询、插入或删除。
   - 操作复杂度为 \(O(1)\)。

3. **有限范围**：
   - 适用于整数范围已知且不大的场景。
   - 若需要支持稀疏数据，位图的效率会降低。

---

## **位图的常见操作**
1. **设置位（Set bit）**：
   - 将指定索引位置的位设置为1。
   - 公式：`bitmap[index / 8] |= (1 << (index % 8))`

2. **清除位（Clear bit）**：
   - 将指定索引位置的位设置为0。
   - 公式：`bitmap[index / 8] &= ~(1 << (index % 8))`

3. **检查位（Check bit）**：
   - 判断指定索引位置的位是否为1。
   - 公式：`bitmap[index / 8] & (1 << (index % 8))`

4. **按位操作**：
   - AND、OR、XOR、NOT等操作可直接作用于位数组。

---

## **位图的典型应用**
1. **去重与查重**：
   - 用于大数据中快速判断某个值是否存在，如哈希表的辅助存储。

2. **布隆过滤器（Bloom Filter）**：
   - 使用多个位图来高效地检测元素是否存在，允许少量的假阳性。

3. **排序和集合运算**：
   - 位图可以对大量整数进行高效的排序和集合操作（如交集、并集）。

4. **标记和状态管理**：
   - 位图常用于操作系统中管理资源（如内存页分配、磁盘块分配）。

---

## **位图的优缺点**

### **优点**
- 高效的存储和操作。
- 在整数范围已知的情况下，能极大减少存储需求。
- 易与硬件结合，支持快速的并行处理。

### **缺点**
- 不适合稀疏数据或范围未知的数据。
- 存在最大范围的限制，无法动态扩展。
- 操作粒度较低，无法直接表示更复杂的状态。